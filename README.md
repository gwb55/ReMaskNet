ReMaskNet: Reconstruction & Masking Network for Anomaly DetectionThis repository contains the PyTorch implementation of ReMaskNet, a framework for unsupervised anomaly detection and localization using the MVTec AD dataset. The model utilizes a multi-stage approach involving feature reconstruction and adaptive masked autoencoding (MAE) to detect anomalies.ğŸ“‚ Project StructurePlaintextâ”œâ”€â”€ main.py           # Main entry point (Training & Testing)
â”œâ”€â”€ train.py          # Training logic
â”œâ”€â”€ test.py           # Testing logic & Visualization
â”œâ”€â”€ run.sh            # Shell script for batch execution
â”œâ”€â”€ mvtec.py          # Dataset loader
â”œâ”€â”€ ReMaskNet.py      # Model architecture
â”œâ”€â”€ utils.py          # Utilities
â””â”€â”€ utils_eval.py     # Evaluation metrics
ğŸ› ï¸ RequirementsPython 3.8+PyTorch (CUDA supported)Torchvision, Numpy, Scikit-learn, SciPy, OpenCV, Matplotlib, tqdmBashpip install torch torchvision numpy scikit-learn scipy opencv-python matplotlib tqdm
ğŸ’¾ Data PreparationThe project expects the following directory structure by default. You can change these paths via command-line arguments.MVTec AD Dataset: Download HereDTD (Describable Textures Dataset): Download HereDefault expected paths:MVTec AD: ./MVTec_adDTD: ./dtd/imagesğŸš€ UsageThe main.py script handles both training and testing.1. TrainingTrain on specific classes (e.g., bottle). Results are saved to ./saved_models.Bashpython main.py --mode train --classes bottle --device cuda:0
To train on multiple classes at once:Bashpython main.py --mode train --classes screw tile toothbrush --batch_size 4
2. TestingEvaluate the model. This will generate a summary CSV and visualizations in ./results.Bashpython main.py --mode test --classes bottle --device cuda:0
3. End-to-End (Train + Test)Run training immediately followed by testing:Bashpython main.py --mode all --classes bottle --epochs 200
âš™ï¸ ArgumentsYou can configure the model using the following arguments in main.py:ArgumentDefaultDescriptionGeneral--modetrainExecution mode: train, test, or all--classes['bottle']List of object classes to process--devicecuda:0Compute device (e.g., cuda:0, cpu)--seed0Random seed for reproducibilityPaths--data_root./MVTec_adPath to MVTec AD dataset--dtd_path./dtd/imagesPath to DTD dataset (for augmentation)--save_root./saved_modelsDirectory to save model checkpoints--result_root./resultsDirectory to save visualizations and CSV resultsHyperparameters--epochs200Number of training epochs--batch_size4Batch size--lr0.0003Learning rate--image_size288Input image size (CenterCropped)--resize329Image resize dimension before cropping--feature_layers2 3Layers of backbone to extract features from--target_embed_dim1536Dimension of the target embeddingModel Specifics--iteration3Number of iterations for the Inpainting training phase--eval_epoch2Interval (in epochs) to run evaluation during training--eval_iteration3Number of inference iterations during testingğŸ“Š OutputsTest ResultsAfter running testing, a summary file is generated at:./results/test_results_summary.csvIt contains the AUROC and AP metrics for both Image-level and Pixel-level detection:ClassImg_AUROCImg_APPix_AUROCPix_APbottle0.99800.99500.98500.9720...............AVERAGE0.99xx0.99xx0.98xx0.97xxVisualizationsVisual results are saved in:./results/visualization/<class_name>/Includes original image, ground truth mask, anomaly heatmap, and segmentation result.
